(this["webpackJsonpsimple-chat"]=this["webpackJsonpsimple-chat"]||[]).push([[0],{116:function(e,s,t){},118:function(e,s,t){},122:function(e,s,t){},123:function(e,s,t){},124:function(e,s,t){"use strict";t.r(s);var c=t(1),a=t.n(c),r=t(57),n=t.n(r),i=(t(65),t(3)),l=t(6),o=t(58),u=t.n(o)()("https://tranquil-reef-66373.herokuapp.com"),d=t(2),j=t.n(d),h=t(8),b=t(27),m=t(35),g=t.n(m),O=(t(116),t(0)),p=function(e){var s=e.className,t=e.register,c=e.placeholder,a=e.defaultValue,r=void 0===a?"":a,n=e.error,l=e.errorMsg,o=void 0===l?"":l;return Object(O.jsxs)("div",{class:"input-with-validate ".concat(n&&"with-error"," ").concat(s),children:[Object(O.jsx)("input",Object(i.a)({defaultValue:r,placeholder:c},t)),n&&Object(O.jsx)("div",{class:"input-with-validate__error",children:o})]})},_=function(e){var s=e.onLogin,t=(e.isLoading,e.setLoading),c=e.defaultName,r=a.a.useState(null),n=Object(l.a)(r,2),i=n[0],o=n[1],u=Object(b.a)(),d=u.register,m=u.handleSubmit,_=u.formState.errors,x=function(){var e=Object(h.a)(j.a.mark((function e(c){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o(null),t(!0),e.next=5,g.a.post("https://tranquil-reef-66373.herokuapp.com/rooms",c);case 5:return e.next=7,g.a.get("https://tranquil-reef-66373.herokuapp.com/rooms/1");case 7:a=e.sent,console.log("getData",a),s(c),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),o("This username already exists");case 15:return e.prev=15,t(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})));return function(s){return e.apply(this,arguments)}}();return Object(O.jsx)(O.Fragment,{children:Object(O.jsx)("div",{class:"entry-page",children:Object(O.jsxs)("form",{class:"entry-page__form",onSubmit:m(x),children:[Object(O.jsx)(p,{className:"entry-page__room-id",errorMsg:"Field required",error:_.roomId,placeholder:"Room id",register:d("roomId",{required:!0})}),Object(O.jsx)(p,{defaultValue:c,className:"entry-page__user-name",errorMsg:i,error:i,placeholder:"Your name",register:d("userName",{required:!0,maxLength:10})}),Object(O.jsx)("button",{className:"entry-page__btn",type:"submit",children:"entry"})]})})})},x=t(4),f=function(e,s){switch(s.type){case"SET_AUTH":return Object(i.a)(Object(i.a)(Object(i.a)({},e),s.payload),{},{isAuth:!0});case"SET_USERS":return Object(i.a)(Object(i.a)({},e),{},{users:s.users});case"SET_MESSAGES":return Object(i.a)(Object(i.a)({},e),{},{messages:s.messages});case"ADD_MSG":return Object(i.a)(Object(i.a)({},e),{},{messages:[].concat(Object(x.a)(e.messages),[s.msg])})}};t(118);var v=function(e){var s=e.loading,t=a.a.useState(!1),c=Object(l.a)(t,2),r=c[0],n=c[1],i=a.a.useRef(null),o=function(e){var s=a.a.useRef();return a.a.useEffect((function(){s.current=e})),s.current}(s);return a.a.useEffect((function(){!s&&o&&(n(!0),clearTimeout(i.current),i.current=setTimeout((function(){n(!1)}),300))}),[s,o]),Object(O.jsx)("div",{style:s||r?{display:"block"}:{display:"none"},className:"main-preloader ".concat(r&&"preloader-closing"),children:Object(O.jsx)("div",{className:"main-preloader__body",children:Object(O.jsx)("div",{className:"main-preloader__icon lds-dual-ring"})})})},S=t(60),y=(t(122),function(e){var s=e.userName,t=e.roomId,c=(e.isAuth,e.users),r=e.messages,n=a.a.useState(!1),o=Object(l.a)(n,2),d=o[0],j=o[1],h=a.a.useRef(null),m=Object(b.a)(),g=m.register,p=m.handleSubmit,_=m.reset;return a.a.useEffect((function(){h.current.scrollTop=h.current.scrollHeight}),[r]),Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(v,{loading:!c.length}),Object(O.jsx)("div",{class:"chat-page",children:Object(O.jsxs)("div",{class:"chat-page__body",children:[Object(O.jsxs)("header",{class:"chat-page__header",children:[Object(O.jsxs)("h3",{class:"chat-page__room",children:["Room #",t]}),Object(O.jsx)(S.a,{queries:{small:"(max-width: 426px)"},children:function(e){return Object(O.jsx)(O.Fragment,{children:e.small?Object(O.jsxs)(O.Fragment,{children:[d?"":Object(O.jsxs)("span",{class:"chat-page__online",children:["Online:"," ",Object(O.jsx)("strong",{children:c.length})]}),Object(O.jsx)("button",{onClick:function(){return j(!d)},className:"chat-page__show-online-btn",children:Object(O.jsx)("svg",{id:"Capa_1","enable-background":"new 0 0 512 512",height:"512",viewBox:"0 0 512 512",width:"512",xmlns:"http://www.w3.org/2000/svg",children:Object(O.jsxs)("g",{children:[Object(O.jsx)("circle",{cx:"256",cy:"119.631",r:"87"}),Object(O.jsx)("circle",{cx:"432",cy:"151.63",r:"55"}),Object(O.jsx)("circle",{cx:"80",cy:"151.63",r:"55"}),Object(O.jsx)("path",{d:"m134.19 256.021c-21.65-17.738-41.257-15.39-66.29-15.39-37.44 0-67.9 30.28-67.9 67.49v109.21c0 16.16 13.19 29.3 29.41 29.3 70.026 0 61.59 1.267 61.59-3.02 0-77.386-9.166-134.137 43.19-187.59z"}),Object(O.jsx)("path",{d:"m279.81 241.03c-43.724-3.647-81.729.042-114.51 27.1-54.857 43.94-44.3 103.103-44.3 175.48 0 19.149 15.58 35.02 35.02 35.02 211.082 0 219.483 6.809 232-20.91 4.105-9.374 2.98-6.395 2.98-96.07 0-71.226-61.673-120.62-111.19-120.62z"}),Object(O.jsx)("path",{d:"m444.1 240.63c-25.17 0-44.669-2.324-66.29 15.39 51.965 53.056 43.19 105.935 43.19 187.59 0 4.314-7.003 3.02 60.54 3.02 16.8 0 30.46-13.61 30.46-30.34v-108.17c0-37.21-30.46-67.49-67.9-67.49z"})]})})})]}):""})}})]}),Object(O.jsxs)("aside",{class:"chat-page__sidebar ".concat(d?"showed":""),children:[Object(O.jsxs)("span",{class:"chat-page__online",children:["Online: ",Object(O.jsx)("strong",{children:c.length})]}),Object(O.jsx)("div",{className:"chat-page__users",children:Object(O.jsx)("div",{class:"chat-page__users-row",children:c.map((function(e,s){return Object(O.jsx)("div",{class:"chat-page__user",children:e},e+s)}))})})]}),Object(O.jsx)("div",{class:"chat-page__dialog chat-dialog",children:Object(O.jsxs)("div",{class:"chat-dialog__body",children:[Object(O.jsx)("div",{ref:h,class:"chat-dialog__messages",id:"chat-msgs-body",children:Object(O.jsx)("div",{class:"chat-dialog__messages-body",children:r.map((function(e){return Object(O.jsxs)("div",{class:"chat-dialog__msg chat-msg ".concat((null===e||void 0===e?void 0:e.userName)==s?"my-msg":""),children:[Object(O.jsx)("span",{class:"chat-msg__name",children:null===e||void 0===e?void 0:e.userName}),Object(O.jsx)("span",{class:"chat-msg__text",children:null===e||void 0===e?void 0:e.text}),Object(O.jsx)("span",{class:"chat-msg__time",children:null===e||void 0===e?void 0:e.time})]})}))})}),Object(O.jsxs)("form",{onSubmit:p((function(e){console.log(e),u.emit("ROOM_NEW_MSG",{roomId:t,userName:s,text:e.message}),_()})),class:"chat-dialog__send-block",children:[Object(O.jsx)("input",Object(i.a)(Object(i.a)({},g("message",{required:!0})),{},{placeholder:"Your message",rows:"2",class:"chat-dialog__input"})),Object(O.jsx)("button",{type:"submit",class:"chat-dialog__send-btn",children:Object(O.jsx)("img",{src:"https://img.icons8.com/material-rounded/192/000000/filled-sent.png"})})]})]})})]})})]})}),E=(t(123),function(){var e=a.a.useState(!1),s=Object(l.a)(e,2),t=s[0],c=s[1],r=a.a.useReducer(f,{userName:null,roomId:null,isAuth:!1,users:[],messages:[]}),n=Object(l.a)(r,2),o=n[0],d=n[1];return a.a.useEffect((function(){u.on("ROOM_SET_USERS",(function(e){return d({type:"SET_USERS",users:e})})),u.on("ROOM_SET_ALL_DATA",(function(e){var s=e.users,t=e.messages;d({type:"SET_USERS",users:s}),d({type:"SET_MESSAGES",messages:t})})),u.on("ROOM_ADD_MSG",(function(e){return d({type:"ADD_MSG",msg:e})}))}),[]),Object(O.jsxs)("div",{className:"app",children:[Object(O.jsx)(v,{loading:t}),o.isAuth?Object(O.jsx)(y,Object(i.a)({},o)):Object(O.jsx)(_,{defaultName:o.userName,onLogin:function(e){d({type:"SET_AUTH",payload:e}),u.emit("ROOM_JOIN",e)},isLoading:t,setLoading:c})]})});n.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(E,{})}),document.getElementById("root"))},65:function(e,s,t){}},[[124,1,2]]]);
//# sourceMappingURL=main.896c9832.chunk.js.map