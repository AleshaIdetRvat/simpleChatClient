{"version":3,"sources":["socket.js","components/EntryPage/EntryPage.jsx","reducers/AppReducer.js","components/common/Preloader/Preloader.jsx","components/ChatPage/ChatPage.jsx","App.jsx","index.js"],"names":["socket","io","InputWithValidate","className","register","placeholder","defaultValue","error","errorMsg","class","EntryPage","onLogin","setLoading","isLoading","defaultName","React","useState","setError","useForm","handleSubmit","errors","formState","onSubmit","data","a","axios","post","roomId","required","maxLength","type","AppReducer","state","action","payload","isAuth","users","messages","msg","Preloader","loading","closing","setClosing","timer","useRef","prevLoading","value","ref","useEffect","current","usePrevious","clearTimeout","setTimeout","style","display","ChatPage","userName","chat","reset","scrollTop","scrollHeight","length","map","user","i","id","text","time","console","log","emit","message","rows","src","App","useReducer","dispatch","on","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.89537406.chunk.js","sourcesContent":["import io from \"socket.io-client\"\r\nconst socket = io()\r\n\r\nexport default socket\r\n","import React from \"react\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport axios from \"axios\"\r\nimport \"./EntryPage.scss\"\r\n\r\nconst InputWithValidate = ({\r\n    className,\r\n    register,\r\n    placeholder,\r\n    defaultValue = \"\",\r\n    error,\r\n    errorMsg = \"\",\r\n}) => {\r\n    return (\r\n        <div class={`input-with-validate ${error && \"with-error\"} ${className}`}>\r\n            <input defaultValue={defaultValue} placeholder={placeholder} {...register} />\r\n            {error && <div class=\"input-with-validate__error\">{errorMsg}</div>}\r\n        </div>\r\n    )\r\n}\r\n\r\nconst EntryPage = ({ onLogin, isLoading, setLoading, defaultName }) => {\r\n    const [error, setError] = React.useState(null)\r\n    const {\r\n        register,\r\n        handleSubmit,\r\n        //watch,\r\n        formState: { errors },\r\n    } = useForm()\r\n\r\n    const onSubmit = async (data) => {\r\n        try {\r\n            setError(null)\r\n            setLoading(true)\r\n            await axios.post(\"https://tranquil-reef-66373.herokuapp.com/rooms\", data)\r\n\r\n            onLogin(data)\r\n        } catch (error) {\r\n            setError(\"This username already exists\")\r\n            //console.log(error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    //console.log(watch(\"example\")) // watch input value by passing the name of it\r\n\r\n    return (\r\n        <>\r\n            <div class=\"entry-page\">\r\n                <form class=\"entry-page__form\" onSubmit={handleSubmit(onSubmit)}>\r\n                    <InputWithValidate\r\n                        className=\"entry-page__room-id\"\r\n                        errorMsg=\"Field required\"\r\n                        error={errors.roomId}\r\n                        placeholder={\"Room id\"}\r\n                        register={register(\"roomId\", { required: true })}\r\n                    />\r\n                    <InputWithValidate\r\n                        defaultValue={defaultName}\r\n                        className=\"entry-page__user-name\"\r\n                        errorMsg={error}\r\n                        error={error}\r\n                        placeholder={\"Your name\"}\r\n                        register={register(\"userName\", { required: true, maxLength: 10 })}\r\n                    />\r\n\r\n                    <button className=\"entry-page__btn\" type=\"submit\">\r\n                        entry\r\n                    </button>\r\n                </form>\r\n            </div>\r\n        </>\r\n    )\r\n    /* \"handleSubmit\" will validate your inputs before invoking \"onSubmit\" */\r\n}\r\n\r\nexport default EntryPage\r\n","const AppReducer = (state, action) => {\r\n    switch (action.type) {\r\n        case \"SET_AUTH\":\r\n            return {\r\n                ...state,\r\n                ...action.payload,\r\n                isAuth: true,\r\n            }\r\n        case \"SET_USERS\":\r\n            return {\r\n                ...state,\r\n                users: action.users,\r\n            }\r\n        case \"SET_MESSAGES\":\r\n            return {\r\n                ...state,\r\n                messages: action.messages,\r\n            }\r\n        case \"ADD_MSG\":\r\n            return {\r\n                ...state,\r\n                messages: [...state.messages, action.msg],\r\n            }\r\n\r\n        default:\r\n            break\r\n    }\r\n}\r\nexport default AppReducer\r\n","import React from \"react\"\r\nimport \"./Preloader.scss\"\r\n\r\nfunction usePrevious(value) {\r\n    const ref = React.useRef()\r\n    React.useEffect(() => {\r\n        ref.current = value\r\n    })\r\n    return ref.current\r\n}\r\n\r\nconst Preloader = ({ loading }) => {\r\n    const [closing, setClosing] = React.useState(false)\r\n\r\n    let timer = React.useRef(null)\r\n    let prevLoading = usePrevious(loading)\r\n\r\n    React.useEffect(() => {\r\n        if (!loading && prevLoading) {\r\n            setClosing(true)\r\n\r\n            clearTimeout(timer.current)\r\n\r\n            timer.current = setTimeout(() => {\r\n                setClosing(false)\r\n            }, 300)\r\n        }\r\n    }, [loading, prevLoading])\r\n    return (\r\n        <div\r\n            style={loading || closing ? { display: \"block\" } : { display: \"none\" }}\r\n            className={`main-preloader ${closing && \"preloader-closing\"}`}\r\n        >\r\n            <div className=\"main-preloader__body\">\r\n                <div className=\"main-preloader__icon lds-dual-ring\"></div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Preloader\r\n","import React from \"react\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport Preloader from \"../common/Preloader/Preloader\"\r\nimport socket from \"../../socket\"\r\nimport \"./ChatPage.scss\"\r\n\r\nconst ChatPage = ({ userName, roomId, isAuth, users, messages }) => {\r\n    //\r\n\r\n    const chat = React.useRef(null)\r\n\r\n    const chatGoDown = () => {\r\n        // it isn't action creator, it is dirty function!)\r\n        //const chatBody = document.getElementById(\"chat-msgs-body\")\r\n        chat.current.scrollTop = chat.current.scrollHeight\r\n    }\r\n\r\n    const {\r\n        register,\r\n        handleSubmit,\r\n        reset,\r\n        //formState: { errors },\r\n    } = useForm()\r\n\r\n    const onSubmit = (msg) => {\r\n        console.log(msg)\r\n        socket.emit(\"ROOM_NEW_MSG\", { roomId, userName, text: msg.message })\r\n        reset()\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        chatGoDown()\r\n    }, [messages])\r\n\r\n    return (\r\n        <>\r\n            <Preloader loading={!users.length} />\r\n            <div class=\"chat-page\">\r\n                <div class=\"chat-page__body\">\r\n                    <header class=\"chat-page__header\">\r\n                        <h3 class=\"chat-page__room\">Room #{roomId}</h3>\r\n                    </header>\r\n                    <aside class=\"chat-page__sidebar\">\r\n                        <span class=\"chat-page__online\">\r\n                            Online: <strong>{users.length}</strong>\r\n                        </span>\r\n                        <div class=\"chat-page__users-row\">\r\n                            {users.map((user, i) => (\r\n                                <div key={user + i} class=\"chat-page__user\">\r\n                                    {user}\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </aside>\r\n                    <div class=\"chat-page__dialog chat-dialog\">\r\n                        <div class=\"chat-dialog__body\">\r\n                            <div\r\n                                ref={chat}\r\n                                class=\"chat-dialog__messages\"\r\n                                id=\"chat-msgs-body\"\r\n                            >\r\n                                <div class=\"chat-dialog__messages-body\">\r\n                                    {messages.map((msg) => (\r\n                                        <div\r\n                                            class={`chat-dialog__msg chat-msg ${\r\n                                                msg?.userName == userName ? \"my-msg\" : \"\"\r\n                                            }`}\r\n                                        >\r\n                                            <span class=\"chat-msg__name\">\r\n                                                {msg?.userName}\r\n                                            </span>\r\n                                            <span class=\"chat-msg__text\">\r\n                                                {msg?.text}\r\n                                            </span>\r\n                                            <span class=\"chat-msg__time\">\r\n                                                {msg?.time}\r\n                                            </span>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                            <form\r\n                                onSubmit={handleSubmit(onSubmit)}\r\n                                class=\"chat-dialog__send-block\"\r\n                            >\r\n                                <input\r\n                                    {...register(\"message\", {\r\n                                        required: true,\r\n                                    })}\r\n                                    placeholder=\"Your message\"\r\n                                    rows=\"2\"\r\n                                    class=\"chat-dialog__input\"\r\n                                />\r\n                                <button type=\"submit\" class=\"chat-dialog__send-btn\">\r\n                                    <img src=\"https://img.icons8.com/material-rounded/192/000000/filled-sent.png\" />\r\n                                </button>\r\n                            </form>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default ChatPage\r\n","import React from \"react\"\nimport socket from \"./socket\"\nimport EntryPage from \"./components/EntryPage/EntryPage\"\nimport AppReducer from \"./reducers/AppReducer\"\nimport ChatPage from \"./components/ChatPage/ChatPage\"\nimport Preloader from \"./components/common/Preloader/Preloader\"\nimport \"./App.scss\"\n\n//window.socket = socket\n\nconst App = () => {\n    const [isLoading, setLoading] = React.useState(false)\n\n    const [state, dispatch] = React.useReducer(AppReducer, {\n        userName: null,\n        roomId: null,\n        isAuth: false,\n        users: [],\n        messages: [],\n    })\n\n    const onLogin = (data) => {\n        dispatch({ type: \"SET_AUTH\", payload: data })\n        socket.emit(\"ROOM_JOIN\", data)\n    }\n    React.useEffect(() => {\n        socket.on(\"ROOM_SET_USERS\", (users) => dispatch({ type: \"SET_USERS\", users }))\n        socket.on(\"ROOM_SET_ALL_DATA\", ({ users, messages }) => {\n            dispatch({ type: \"SET_USERS\", users })\n            dispatch({ type: \"SET_MESSAGES\", messages })\n        })\n        socket.on(\"ROOM_ADD_MSG\", (msg) => dispatch({ type: \"ADD_MSG\", msg }))\n    }, [])\n\n    return (\n        <div className=\"app\">\n            <Preloader loading={isLoading} />\n            {state.isAuth ? (\n                <ChatPage {...state} />\n            ) : (\n                <EntryPage\n                    defaultName={state.userName}\n                    onLogin={onLogin}\n                    isLoading={isLoading}\n                    setLoading={setLoading}\n                />\n            )}\n        </div>\n    )\n}\n\nexport default App\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport \"./index.css\"\nimport App from \"./App\"\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n)\n"],"sourceRoot":""}