{"version":3,"sources":["socket.js","reducers/AppReducer.js","components/common/Preloader/Preloader.jsx","components/ChatPage/ChatPage.jsx","App.jsx","index.js"],"names":["socket","io","AppReducer","state","action","type","payload","isAuth","users","messages","msg","ChatPage","userName","roomId","React","useState","showSidebar","setShowSidebar","chat","useRef","useForm","register","handleSubmit","reset","useEffect","current","scrollTop","scrollHeight","class","queries","small","matches","length","onClick","className","id","enable-background","height","viewBox","width","xmlns","cx","cy","r","d","map","user","i","ref","text","time","onSubmit","console","log","emit","message","required","placeholder","rows","src","App","useReducer","dispatch","on","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.9d4b3f7b.chunk.js","sourcesContent":["import io from \"socket.io-client\"\r\nconst socket = io(\"https://tranquil-reef-66373.herokuapp.com\")\r\n\r\nexport default socket\r\n","const AppReducer = (state, action) => {\r\n    switch (action.type) {\r\n        case \"SET_AUTH\":\r\n            return {\r\n                ...state,\r\n                ...action.payload,\r\n                isAuth: true,\r\n            }\r\n        case \"SET_USERS\":\r\n            return {\r\n                ...state,\r\n                users: action.users,\r\n            }\r\n        case \"SET_MESSAGES\":\r\n            return {\r\n                ...state,\r\n                messages: action.messages,\r\n            }\r\n        case \"ADD_MSG\":\r\n            return {\r\n                ...state,\r\n                messages: [...state.messages, action.msg],\r\n            }\r\n\r\n        default:\r\n            break\r\n    }\r\n}\r\nexport default AppReducer\r\n","import React from \"react\"\r\nimport \"./Preloader.scss\"\r\n\r\nfunction usePrevious(value) {\r\n    const ref = React.useRef()\r\n    React.useEffect(() => {\r\n        ref.current = value\r\n    })\r\n    return ref.current\r\n}\r\n\r\nconst Preloader = ({ loading }) => {\r\n    const [closing, setClosing] = React.useState(false)\r\n\r\n    let timer = React.useRef(null)\r\n    let prevLoading = usePrevious(loading)\r\n\r\n    React.useEffect(() => {\r\n        if (!loading && prevLoading) {\r\n            setClosing(true)\r\n\r\n            clearTimeout(timer.current)\r\n\r\n            timer.current = setTimeout(() => {\r\n                setClosing(false)\r\n            }, 300)\r\n        }\r\n    }, [loading, prevLoading])\r\n    return (\r\n        <div\r\n            style={loading || closing ? { display: \"block\" } : { display: \"none\" }}\r\n            className={`main-preloader ${closing && \"preloader-closing\"}`}\r\n        >\r\n            <div className=\"main-preloader__body\">\r\n                <div className=\"main-preloader__icon lds-dual-ring\"></div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Preloader\r\n","import React from \"react\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport Preloader from \"../common/Preloader/Preloader\"\r\nimport socket from \"../../socket\"\r\nimport Media from \"react-media\"\r\nimport \"./ChatPage.scss\"\r\n\r\nconst ChatPage = ({ userName, roomId, isAuth, users, messages }) => {\r\n    //\r\n    const [showSidebar, setShowSidebar] = React.useState(false)\r\n\r\n    const chat = React.useRef(null)\r\n\r\n    const chatGoDown = () => {\r\n        // it isn't action creator, it is dirty function!)\r\n        //const chatBody = document.getElementById(\"chat-msgs-body\")\r\n        chat.current.scrollTop = chat.current.scrollHeight\r\n    }\r\n\r\n    const {\r\n        register,\r\n        handleSubmit,\r\n        reset,\r\n        //formState: { errors },\r\n    } = useForm()\r\n\r\n    const onSubmit = (msg) => {\r\n        console.log(msg)\r\n        socket.emit(\"ROOM_NEW_MSG\", { roomId, userName, text: msg.message })\r\n        reset()\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        chatGoDown()\r\n    }, [messages])\r\n\r\n    return (\r\n        <>\r\n            {/* <Preloader loading={!users.length} /> */}\r\n\r\n            <div class=\"chat-page\">\r\n                <div class=\"chat-page__body\">\r\n                    <header class=\"chat-page__header\">\r\n                        <h3 class=\"chat-page__room\">Room #{roomId}</h3>\r\n\r\n                        <Media\r\n                            queries={{\r\n                                small: \"(max-width: 426px)\",\r\n                            }}\r\n                        >\r\n                            {(matches) => (\r\n                                <>\r\n                                    {matches.small ? (\r\n                                        <>\r\n                                            {showSidebar ? (\r\n                                                \"\"\r\n                                            ) : (\r\n                                                <span class=\"chat-page__online\">\r\n                                                    Online:{\" \"}\r\n                                                    <strong>{users.length}</strong>\r\n                                                </span>\r\n                                            )}\r\n                                            <button\r\n                                                onClick={() =>\r\n                                                    setShowSidebar(!showSidebar)\r\n                                                }\r\n                                                className=\"chat-page__show-online-btn\"\r\n                                            >\r\n                                                <svg\r\n                                                    id=\"Capa_1\"\r\n                                                    enable-background=\"new 0 0 512 512\"\r\n                                                    height=\"512\"\r\n                                                    viewBox=\"0 0 512 512\"\r\n                                                    width=\"512\"\r\n                                                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                                                >\r\n                                                    <g>\r\n                                                        <circle\r\n                                                            cx=\"256\"\r\n                                                            cy=\"119.631\"\r\n                                                            r=\"87\"\r\n                                                        />\r\n                                                        <circle\r\n                                                            cx=\"432\"\r\n                                                            cy=\"151.63\"\r\n                                                            r=\"55\"\r\n                                                        />\r\n                                                        <circle\r\n                                                            cx=\"80\"\r\n                                                            cy=\"151.63\"\r\n                                                            r=\"55\"\r\n                                                        />\r\n                                                        <path d=\"m134.19 256.021c-21.65-17.738-41.257-15.39-66.29-15.39-37.44 0-67.9 30.28-67.9 67.49v109.21c0 16.16 13.19 29.3 29.41 29.3 70.026 0 61.59 1.267 61.59-3.02 0-77.386-9.166-134.137 43.19-187.59z\" />\r\n                                                        <path d=\"m279.81 241.03c-43.724-3.647-81.729.042-114.51 27.1-54.857 43.94-44.3 103.103-44.3 175.48 0 19.149 15.58 35.02 35.02 35.02 211.082 0 219.483 6.809 232-20.91 4.105-9.374 2.98-6.395 2.98-96.07 0-71.226-61.673-120.62-111.19-120.62z\" />\r\n                                                        <path d=\"m444.1 240.63c-25.17 0-44.669-2.324-66.29 15.39 51.965 53.056 43.19 105.935 43.19 187.59 0 4.314-7.003 3.02 60.54 3.02 16.8 0 30.46-13.61 30.46-30.34v-108.17c0-37.21-30.46-67.49-67.9-67.49z\" />\r\n                                                    </g>\r\n                                                </svg>\r\n                                            </button>\r\n                                        </>\r\n                                    ) : (\r\n                                        \"\"\r\n                                    )}\r\n                                </>\r\n                            )}\r\n                        </Media>\r\n                    </header>\r\n                    <aside class={`chat-page__sidebar ${showSidebar ? \"showed\" : \"\"}`}>\r\n                        <span class=\"chat-page__online\">\r\n                            Online: <strong>{users.length}</strong>\r\n                        </span>\r\n                        <div className=\"chat-page__users\">\r\n                            <div class=\"chat-page__users-row\">\r\n                                {users.map((user, i) => (\r\n                                    <div key={user + i} class=\"chat-page__user\">\r\n                                        {user}\r\n                                    </div>\r\n                                ))}\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                                <div class=\"chat-page__user\">testtsds</div>\r\n                            </div>\r\n                        </div>\r\n                    </aside>\r\n\r\n                    <div class=\"chat-page__dialog chat-dialog\">\r\n                        <div class=\"chat-dialog__body\">\r\n                            <div\r\n                                ref={chat}\r\n                                class=\"chat-dialog__messages\"\r\n                                id=\"chat-msgs-body\"\r\n                            >\r\n                                <div class=\"chat-dialog__messages-body\">\r\n                                    {messages.map((msg) => (\r\n                                        <div\r\n                                            class={`chat-dialog__msg chat-msg ${\r\n                                                msg?.userName == userName ? \"my-msg\" : \"\"\r\n                                            }`}\r\n                                        >\r\n                                            <span class=\"chat-msg__name\">\r\n                                                {msg?.userName}\r\n                                            </span>\r\n                                            <span class=\"chat-msg__text\">\r\n                                                {msg?.text}\r\n                                            </span>\r\n                                            <span class=\"chat-msg__time\">\r\n                                                {msg?.time}\r\n                                            </span>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                            <form\r\n                                onSubmit={handleSubmit(onSubmit)}\r\n                                class=\"chat-dialog__send-block\"\r\n                            >\r\n                                <input\r\n                                    {...register(\"message\", {\r\n                                        required: true,\r\n                                    })}\r\n                                    placeholder=\"Your message\"\r\n                                    rows=\"2\"\r\n                                    class=\"chat-dialog__input\"\r\n                                />\r\n                                <button type=\"submit\" class=\"chat-dialog__send-btn\">\r\n                                    <img src=\"https://img.icons8.com/material-rounded/192/000000/filled-sent.png\" />\r\n                                </button>\r\n                            </form>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default ChatPage\r\n","import React from \"react\"\nimport socket from \"./socket\"\nimport EntryPage from \"./components/EntryPage/EntryPage\"\nimport AppReducer from \"./reducers/AppReducer\"\nimport ChatPage from \"./components/ChatPage/ChatPage\"\nimport Preloader from \"./components/common/Preloader/Preloader\"\nimport \"./App.scss\"\n\n//window.socket = socket\n\nconst App = () => {\n    const [isLoading, setLoading] = React.useState(false)\n\n    const [state, dispatch] = React.useReducer(AppReducer, {\n        userName: null,\n        roomId: null,\n        isAuth: false,\n        users: [],\n        messages: [],\n    })\n\n    const onLogin = (data) => {\n        dispatch({ type: \"SET_AUTH\", payload: data })\n        socket.emit(\"ROOM_JOIN\", data)\n    }\n    React.useEffect(() => {\n        socket.on(\"ROOM_SET_USERS\", (users) => dispatch({ type: \"SET_USERS\", users }))\n        socket.on(\"ROOM_SET_ALL_DATA\", ({ users, messages }) => {\n            dispatch({ type: \"SET_USERS\", users })\n            dispatch({ type: \"SET_MESSAGES\", messages })\n        })\n        socket.on(\"ROOM_ADD_MSG\", (msg) => dispatch({ type: \"ADD_MSG\", msg }))\n    }, [])\n\n    return (\n        <div className=\"app\">\n            <ChatPage {...state} />\n        </div>\n        // <div className=\"app\">\n        //     <Preloader loading={isLoading} />\n        //     {state.isAuth ? (\n        //         <ChatPage {...state} />\n        //     ) : (\n        //         <EntryPage\n        //             defaultName={state.userName}\n        //             onLogin={onLogin}\n        //             isLoading={isLoading}\n        //             setLoading={setLoading}\n        //         />\n        //     )}\n        // </div>\n    )\n}\n\nexport default App\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport \"./index.css\"\nimport App from \"./App\"\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n)\n"],"sourceRoot":""}